{"remainingRequest":"/home/d/github/box-im/im-web/node_modules/babel-loader/lib/index.js!/home/d/github/box-im/im-web/node_modules/eslint-loader/index.js??ref--14-0!/home/d/github/box-im/im-web/src/api/camera.js","dependencies":[{"path":"/home/d/github/box-im/im-web/src/api/camera.js","mtime":1727013808912},{"path":"/home/d/github/box-im/im-web/babel.config.js","mtime":1727013808912},{"path":"/home/d/github/box-im/im-web/node_modules/cache-loader/dist/cjs.js","mtime":1727014166207},{"path":"/home/d/github/box-im/im-web/node_modules/babel-loader/lib/index.js","mtime":1727014166227},{"path":"/home/d/github/box-im/im-web/node_modules/eslint-loader/index.js","mtime":1727014164203}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Y2xhc3MgSW1DYW1lcmEgewogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5zdHJlYW0gPSBudWxsOwogIH0KfQpJbUNhbWVyYS5wcm90b3R5cGUuaXNFbmFibGUgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuICEhbmF2aWdhdG9yICYmICEhbmF2aWdhdG9yLm1lZGlhRGV2aWNlcyAmJiAhIW5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhOwp9OwpJbUNhbWVyYS5wcm90b3R5cGUub3BlblZpZGVvID0gZnVuY3Rpb24gKCkgewogIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICBpZiAodGhpcy5zdHJlYW0pIHsKICAgICAgdGhpcy5jbG9zZSgpOwogICAgfQogICAgbGV0IGNvbnN0cmFpbnRzID0gewogICAgICB2aWRlbzogewogICAgICAgIHdpdGg6IHdpbmRvdy5zY3JlZW4ud2lkdGgsCiAgICAgICAgaGVpZ2h0OiB3aW5kb3cuc2NyZWVuLmhlaWdodAogICAgICB9LAogICAgICBhdWRpbzogewogICAgICAgIGVjaG9DYW5jZWxsYXRpb246IHRydWUsCiAgICAgICAgLy/pn7PpopHlvIDlkK/lm57pn7PmtojpmaQKICAgICAgICBub2lzZVN1cHByZXNzaW9uOiB0cnVlIC8vIOW8gOWQr+mZjeWZqgogICAgICB9CiAgICB9OwogICAgY29uc29sZS5sb2coImdldFVzZXJNZWRpYSIpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4oc3RyZWFtID0+IHsKICAgICAgY29uc29sZS5sb2coIuaRhOWDj+WktOaJk+W8gCIpOwogICAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTsKICAgICAgcmVzb2x2ZShzdHJlYW0pOwogICAgfSkuY2F0Y2goZSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICBjb25zb2xlLmxvZygi5pGE5YOP5aS05pyq6IO95q2j5bi45omT5byAIik7CiAgICAgIHJlamVjdCh7CiAgICAgICAgY29kZTogMCwKICAgICAgICBtZXNzYWdlOiAi5pGE5YOP5aS05pyq6IO95q2j5bi45omT5byAIgogICAgICB9KTsKICAgIH0pOwogIH0pOwp9OwpJbUNhbWVyYS5wcm90b3R5cGUub3BlbkF1ZGlvID0gZnVuY3Rpb24gKCkgewogIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICBsZXQgY29uc3RyYWludHMgPSB7CiAgICAgIHZpZGVvOiBmYWxzZSwKICAgICAgYXVkaW86IHsKICAgICAgICBlY2hvQ2FuY2VsbGF0aW9uOiB0cnVlLAogICAgICAgIC8v6Z+z6aKR5byA5ZCv5Zue6Z+z5raI6ZmkCiAgICAgICAgbm9pc2VTdXBwcmVzc2lvbjogdHJ1ZSAvLyDlvIDlkK/pmY3lmaoKICAgICAgfQogICAgfTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKS50aGVuKHN0cmVhbSA9PiB7CiAgICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgICByZXNvbHZlKHN0cmVhbSk7CiAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCLpuqblhYvpo47mnKrog73mraPluLjmiZPlvIAiKTsKICAgICAgcmVqZWN0KHsKICAgICAgICBjb2RlOiAwLAogICAgICAgIG1lc3NhZ2U6ICLpuqblhYvpo47mnKrog73mraPluLjmiZPlvIAiCiAgICAgIH0pOwogICAgfSk7CiAgfSk7Cn07CkltQ2FtZXJhLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAvLyDlgZzmraLmtYEKICBpZiAodGhpcy5zdHJlYW0pIHsKICAgIHRoaXMuc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godHJhY2sgPT4gewogICAgICB0cmFjay5zdG9wKCk7CiAgICB9KTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IEltQ2FtZXJhOw=="},{"version":3,"names":["ImCamera","constructor","stream","prototype","isEnable","navigator","mediaDevices","getUserMedia","openVideo","Promise","resolve","reject","close","constraints","video","with","window","screen","width","height","audio","echoCancellation","noiseSuppression","console","log","then","catch","e","code","message","openAudio","getTracks","forEach","track","stop"],"sources":["/home/d/github/box-im/im-web/src/api/camera.js"],"sourcesContent":["\nclass ImCamera {\n\tconstructor() {\n\t\tthis.stream = null;\n\t}\n}\n\nImCamera.prototype.isEnable = function() {\n\treturn !!navigator && !!navigator.mediaDevices && !!navigator.mediaDevices.getUserMedia;\n}\n\nImCamera.prototype.openVideo = function() {\n\treturn new Promise((resolve, reject) => {\n\t\tif(this.stream){\n\t\t\tthis.close()\n\t\t}\n\t\tlet constraints = {\n\t\t\tvideo: {\n\t\t\t\twith: window.screen.width,\n\t\t\t\theight: window.screen.height\n\t\t\t},\n\t\t\taudio: {\n\t\t\t\techoCancellation: true, //音频开启回音消除\n\t\t\t\tnoiseSuppression: true // 开启降噪\n\t\t\t}\n\t\t}\n\t\tconsole.log(\"getUserMedia\")\n\t\tnavigator.mediaDevices.getUserMedia(constraints).then((stream) => {\n\t\t\tconsole.log(\"摄像头打开\")\n\t\t\tthis.stream = stream;\n\t\t\tresolve(stream);\n\t\t}).catch((e) => {\n\t\t\tconsole.log(e)\n\t\t\tconsole.log(\"摄像头未能正常打开\")\n\t\t\treject({\n\t\t\t\tcode: 0,\n\t\t\t\tmessage: \"摄像头未能正常打开\"\n\t\t\t})\n\t\t})\n\t})\n}\n\n\nImCamera.prototype.openAudio = function() {\n\treturn new Promise((resolve, reject) => {\n\t\tlet constraints = {\n\t\t\tvideo: false,\n\t\t\taudio: {\n\t\t\t\techoCancellation: true, //音频开启回音消除\n\t\t\t\tnoiseSuppression: true // 开启降噪\n\t\t\t}\n\t\t}\n\t\tnavigator.mediaDevices.getUserMedia(constraints).then((stream) => {\n\t\t\tthis.stream = stream;\n\t\t\tresolve(stream);\n\t\t}).catch(() => {\n\t\t\tconsole.log(\"麦克风未能正常打开\")\n\t\t\treject({\n\t\t\t\tcode: 0,\n\t\t\t\tmessage: \"麦克风未能正常打开\"\n\t\t\t})\n\t\t})\n\n\t})\n}\n\nImCamera.prototype.close = function() {\n\t// 停止流\n\tif (this.stream) {\n\t\tthis.stream.getTracks().forEach((track) => {\n\t\t\ttrack.stop();\n\t\t});\n\t}\n}\n\nexport default ImCamera;"],"mappings":"AACA,MAAMA,QAAQ,CAAC;EACdC,WAAWA,CAAA,EAAG;IACb,IAAI,CAACC,MAAM,GAAG,IAAI;EACnB;AACD;AAEAF,QAAQ,CAACG,SAAS,CAACC,QAAQ,GAAG,YAAW;EACxC,OAAO,CAAC,CAACC,SAAS,IAAI,CAAC,CAACA,SAAS,CAACC,YAAY,IAAI,CAAC,CAACD,SAAS,CAACC,YAAY,CAACC,YAAY;AACxF,CAAC;AAEDP,QAAQ,CAACG,SAAS,CAACK,SAAS,GAAG,YAAW;EACzC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACvC,IAAG,IAAI,CAACT,MAAM,EAAC;MACd,IAAI,CAACU,KAAK,CAAC,CAAC;IACb;IACA,IAAIC,WAAW,GAAG;MACjBC,KAAK,EAAE;QACNC,IAAI,EAAEC,MAAM,CAACC,MAAM,CAACC,KAAK;QACzBC,MAAM,EAAEH,MAAM,CAACC,MAAM,CAACE;MACvB,CAAC;MACDC,KAAK,EAAE;QACNC,gBAAgB,EAAE,IAAI;QAAE;QACxBC,gBAAgB,EAAE,IAAI,CAAC;MACxB;IACD,CAAC;IACDC,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;IAC3BnB,SAAS,CAACC,YAAY,CAACC,YAAY,CAACM,WAAW,CAAC,CAACY,IAAI,CAAEvB,MAAM,IAAK;MACjEqB,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;MACpB,IAAI,CAACtB,MAAM,GAAGA,MAAM;MACpBQ,OAAO,CAACR,MAAM,CAAC;IAChB,CAAC,CAAC,CAACwB,KAAK,CAAEC,CAAC,IAAK;MACfJ,OAAO,CAACC,GAAG,CAACG,CAAC,CAAC;MACdJ,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;MACxBb,MAAM,CAAC;QACNiB,IAAI,EAAE,CAAC;QACPC,OAAO,EAAE;MACV,CAAC,CAAC;IACH,CAAC,CAAC;EACH,CAAC,CAAC;AACH,CAAC;AAGD7B,QAAQ,CAACG,SAAS,CAAC2B,SAAS,GAAG,YAAW;EACzC,OAAO,IAAIrB,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACvC,IAAIE,WAAW,GAAG;MACjBC,KAAK,EAAE,KAAK;MACZM,KAAK,EAAE;QACNC,gBAAgB,EAAE,IAAI;QAAE;QACxBC,gBAAgB,EAAE,IAAI,CAAC;MACxB;IACD,CAAC;IACDjB,SAAS,CAACC,YAAY,CAACC,YAAY,CAACM,WAAW,CAAC,CAACY,IAAI,CAAEvB,MAAM,IAAK;MACjE,IAAI,CAACA,MAAM,GAAGA,MAAM;MACpBQ,OAAO,CAACR,MAAM,CAAC;IAChB,CAAC,CAAC,CAACwB,KAAK,CAAC,MAAM;MACdH,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;MACxBb,MAAM,CAAC;QACNiB,IAAI,EAAE,CAAC;QACPC,OAAO,EAAE;MACV,CAAC,CAAC;IACH,CAAC,CAAC;EAEH,CAAC,CAAC;AACH,CAAC;AAED7B,QAAQ,CAACG,SAAS,CAACS,KAAK,GAAG,YAAW;EACrC;EACA,IAAI,IAAI,CAACV,MAAM,EAAE;IAChB,IAAI,CAACA,MAAM,CAAC6B,SAAS,CAAC,CAAC,CAACC,OAAO,CAAEC,KAAK,IAAK;MAC1CA,KAAK,CAACC,IAAI,CAAC,CAAC;IACb,CAAC,CAAC;EACH;AACD,CAAC;AAED,eAAelC,QAAQ","ignoreList":[]}]}