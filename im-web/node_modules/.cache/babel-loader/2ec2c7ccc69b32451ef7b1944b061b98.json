{"remainingRequest":"/home/d/github/box-im/im-web/node_modules/babel-loader/lib/index.js!/home/d/github/box-im/im-web/node_modules/eslint-loader/index.js??ref--14-0!/home/d/github/box-im/im-web/src/api/httpRequest.js","dependencies":[{"path":"/home/d/github/box-im/im-web/src/api/httpRequest.js","mtime":1727013808912},{"path":"/home/d/github/box-im/im-web/babel.config.js","mtime":1727013808912},{"path":"/home/d/github/box-im/im-web/node_modules/cache-loader/dist/cjs.js","mtime":1727014166207},{"path":"/home/d/github/box-im/im-web/node_modules/babel-loader/lib/index.js","mtime":1727014166227},{"path":"/home/d/github/box-im/im-web/node_modules/eslint-loader/index.js","mtime":1727014164203}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHsgTWVzc2FnZSB9IGZyb20gJ2VsZW1lbnQtdWknOwpjb25zdCBodHRwID0gYXhpb3MuY3JlYXRlKHsKICBiYXNlVVJMOiBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJLAogIHRpbWVvdXQ6IDEwMDAgKiAzMCwKICB3aXRoQ3JlZGVudGlhbHM6IHRydWUKfSk7CgovKioKICog6K+35rGC5oum5oiqCiAqLwpodHRwLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShjb25maWcgPT4gewogIGxldCBhY2Nlc3NUb2tlbiA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImFjY2Vzc1Rva2VuIik7CiAgaWYgKGFjY2Vzc1Rva2VuKSB7CiAgICBjb25maWcuaGVhZGVycy5hY2Nlc3NUb2tlbiA9IGVuY29kZVVSSUNvbXBvbmVudChhY2Nlc3NUb2tlbik7CiAgfQogIHJldHVybiBjb25maWc7Cn0sIGVycm9yID0+IHsKICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwp9KTsKCi8qKgogKiDlk43lupTmi6bmiKoKICovCmh0dHAuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShhc3luYyByZXNwb25zZSA9PiB7CiAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PSAyMDApIHsKICAgIHJldHVybiByZXNwb25zZS5kYXRhLmRhdGE7CiAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT0gNDAwKSB7CiAgICBsb2NhdGlvbi5ocmVmID0gIi8iOwogIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09IDQwMSkgewogICAgY29uc29sZS5sb2coInRva2Vu5aSx5pWI77yM5bCd6K+V6YeN5paw6I635Y+WIik7CiAgICBsZXQgcmVmcmVzaFRva2VuID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgicmVmcmVzaFRva2VuIik7CiAgICBpZiAoIXJlZnJlc2hUb2tlbikgewogICAgICBsb2NhdGlvbi5ocmVmID0gIi8iOwogICAgfQogICAgLy8g5Y+R6YCB6K+35rGCLCDov5vooYzliLfmlrB0b2tlbuaTjeS9nCwg6I635Y+W5paw55qEdG9rZW4KICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBodHRwKHsKICAgICAgbWV0aG9kOiAncHV0JywKICAgICAgdXJsOiAnL3JlZnJlc2hUb2tlbicsCiAgICAgIGhlYWRlcnM6IHsKICAgICAgICByZWZyZXNoVG9rZW46IHJlZnJlc2hUb2tlbgogICAgICB9CiAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgIGxvY2F0aW9uLmhyZWYgPSAiLyI7CiAgICB9KTsKICAgIC8vIOS/neWtmHRva2VuCiAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCJhY2Nlc3NUb2tlbiIsIGRhdGEuYWNjZXNzVG9rZW4pOwogICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgicmVmcmVzaFRva2VuIiwgZGF0YS5yZWZyZXNoVG9rZW4pOwogICAgLy8g6YeN5paw5Y+R6YCB5Yia5omN55qE6K+35rGCCiAgICByZXR1cm4gaHR0cChyZXNwb25zZS5jb25maWcpOwogIH0gZWxzZSB7CiAgICBNZXNzYWdlKHsKICAgICAgbWVzc2FnZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLAogICAgICB0eXBlOiAnZXJyb3InLAogICAgICBkdXJhdGlvbjogMTUwMCwKICAgICAgY3VzdG9tQ2xhc3M6ICdlbGVtZW50LWVycm9yLW1lc3NhZ2UtemluZGV4JwogICAgfSk7CiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzcG9uc2UuZGF0YSk7CiAgfQp9LCBlcnJvciA9PiB7CiAgc3dpdGNoIChlcnJvci5yZXNwb25zZS5zdGF0dXMpIHsKICAgIGNhc2UgNDAwOgogICAgICBNZXNzYWdlKHsKICAgICAgICBtZXNzYWdlOiBlcnJvci5yZXNwb25zZS5kYXRhLAogICAgICAgIHR5cGU6ICdlcnJvcicsCiAgICAgICAgZHVyYXRpb246IDE1MDAsCiAgICAgICAgY3VzdG9tQ2xhc3M6ICdlbGVtZW50LWVycm9yLW1lc3NhZ2UtemluZGV4JwogICAgICB9KTsKICAgICAgYnJlYWs7CiAgICBjYXNlIDQwMToKICAgICAgbG9jYXRpb24uaHJlZiA9ICIvIjsKICAgICAgYnJlYWs7CiAgICBjYXNlIDQwNToKICAgICAgTWVzc2FnZSh7CiAgICAgICAgbWVzc2FnZTogJ2h0dHDor7fmsYLmlrnlvI/mnInor68nLAogICAgICAgIHR5cGU6ICdlcnJvcicsCiAgICAgICAgZHVyYXRpb246IDE1MDAsCiAgICAgICAgY3VzdG9tQ2xhc3M6ICdlbGVtZW50LWVycm9yLW1lc3NhZ2UtemluZGV4JwogICAgICB9KTsKICAgICAgYnJlYWs7CiAgICBjYXNlIDQwNDoKICAgIGNhc2UgNTAwOgogICAgICBNZXNzYWdlKHsKICAgICAgICBtZXNzYWdlOiAn5pyN5Yqh5Zmo5Ye65LqG54K55bCP5beu77yM6K+356iN5ZCO5YaN6K+VJywKICAgICAgICB0eXBlOiAnZXJyb3InLAogICAgICAgIGR1cmF0aW9uOiAxNTAwLAogICAgICAgIGN1c3RvbUNsYXNzOiAnZWxlbWVudC1lcnJvci1tZXNzYWdlLXppbmRleCcKICAgICAgfSk7CiAgICAgIGJyZWFrOwogICAgY2FzZSA1MDE6CiAgICAgIE1lc3NhZ2UoewogICAgICAgIG1lc3NhZ2U6ICfmnI3liqHlmajkuI3mlK/mjIHlvZPliY3or7fmsYLmiYDpnIDopoHnmoTmn5DkuKrlip/og70nLAogICAgICAgIHR5cGU6ICdlcnJvcicsCiAgICAgICAgZHVyYXRpb246IDE1MDAsCiAgICAgICAgY3VzdG9tQ2xhc3M6ICdlbGVtZW50LWVycm9yLW1lc3NhZ2UtemluZGV4JwogICAgICB9KTsKICAgICAgYnJlYWs7CiAgfQogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn0pOwpleHBvcnQgZGVmYXVsdCBodHRwOw=="},{"version":3,"names":["axios","Message","http","create","baseURL","process","env","VUE_APP_BASE_API","timeout","withCredentials","interceptors","request","use","config","accessToken","sessionStorage","getItem","headers","encodeURIComponent","error","Promise","reject","response","data","code","location","href","console","log","refreshToken","method","url","catch","setItem","message","type","duration","customClass","status"],"sources":["/home/d/github/box-im/im-web/src/api/httpRequest.js"],"sourcesContent":["import axios from 'axios'\n\nimport { Message } from 'element-ui'\n\nconst http = axios.create({\n\tbaseURL: process.env.VUE_APP_BASE_API,\n\ttimeout: 1000 * 30,\n\twithCredentials: true\n})\n\n/**\n * 请求拦截\n */\nhttp.interceptors.request.use(config => {\n\tlet accessToken = sessionStorage.getItem(\"accessToken\");\n\tif (accessToken) {\n\t\tconfig.headers.accessToken = encodeURIComponent(accessToken);\n\t}\n\treturn config\n}, error => {\n\treturn Promise.reject(error)\n})\n\n/**\n * 响应拦截\n */\nhttp.interceptors.response.use(async response => {\n\tif (response.data.code == 200) {\n\t\treturn response.data.data;\n\t} else if (response.data.code == 400) {\n\t\tlocation.href = \"/\";\n\t} else if (response.data.code == 401) {\n\t\tconsole.log(\"token失效，尝试重新获取\")\n\t\tlet refreshToken = sessionStorage.getItem(\"refreshToken\");\n\t\tif (!refreshToken) {\n\t\t\tlocation.href = \"/\";\n\t\t}\n\t\t// 发送请求, 进行刷新token操作, 获取新的token\n\t\tconst data = await http({\n\t\t\tmethod: 'put',\n\t\t\turl: '/refreshToken',\n\t\t\theaders: {\n\t\t\t\trefreshToken: refreshToken\n\t\t\t}\n\t\t}).catch(()=>{\n\t\t\tlocation.href = \"/\";\n\t\t})\n\t\t// 保存token\n\t\tsessionStorage.setItem(\"accessToken\", data.accessToken);\n\t\tsessionStorage.setItem(\"refreshToken\", data.refreshToken);\n\t\t// 重新发送刚才的请求\n\t\treturn http(response.config)\n\t} else {\n\t\tMessage({\n\t\t\tmessage: response.data.message,\n\t\t\ttype: 'error',\n\t\t\tduration: 1500,\n\t\t\tcustomClass: 'element-error-message-zindex'\n\t\t})\n\t\treturn Promise.reject(response.data)\n\t}\n}, error => {\n\tswitch (error.response.status) {\n\t\tcase 400:\n\t\t\tMessage({\n\t\t\t\tmessage: error.response.data,\n\t\t\t\ttype: 'error',\n\t\t\t\tduration: 1500,\n\t\t\t\tcustomClass: 'element-error-message-zindex'\n\t\t\t})\n\t\t\tbreak\n\t\tcase 401:\n\t\t\tlocation.href = \"/\";\n\t\t\tbreak\n\t\tcase 405:\n\t\t\tMessage({\n\t\t\t\tmessage: 'http请求方式有误',\n\t\t\t\ttype: 'error',\n\t\t\t\tduration: 1500,\n\t\t\t\tcustomClass: 'element-error-message-zindex'\n\t\t\t})\n\t\t\tbreak\n\t\tcase 404:\n\t\tcase 500:\n\t\t\tMessage({\n\t\t\t\tmessage: '服务器出了点小差，请稍后再试',\n\t\t\t\ttype: 'error',\n\t\t\t\tduration: 1500,\n\t\t\t\tcustomClass: 'element-error-message-zindex'\n\t\t\t})\n\t\t\tbreak\n\t\tcase 501:\n\t\t\tMessage({\n\t\t\t\tmessage: '服务器不支持当前请求所需要的某个功能',\n\t\t\t\ttype: 'error',\n\t\t\t\tduration: 1500,\n\t\t\t\tcustomClass: 'element-error-message-zindex'\n\t\t\t})\n\t\t\tbreak\n\t}\n\n\treturn Promise.reject(error)\n})\n\n\nexport default http\n"],"mappings":"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","ignoreList":[]}]}