{"remainingRequest":"/home/d/github/box-im/im-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/d/github/box-im/im-web/src/components/chat/ChatBox.vue?vue&type=style&index=0&id=35ac558c&lang=scss","dependencies":[{"path":"/home/d/github/box-im/im-web/src/components/chat/ChatBox.vue","mtime":1727013808920},{"path":"/home/d/github/box-im/im-web/node_modules/css-loader/dist/cjs.js","mtime":1727014164027},{"path":"/home/d/github/box-im/im-web/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1727014163855},{"path":"/home/d/github/box-im/im-web/node_modules/postcss-loader/src/index.js","mtime":1727014163867},{"path":"/home/d/github/box-im/im-web/node_modules/sass-loader/dist/cjs.js","mtime":1727014166331},{"path":"/home/d/github/box-im/im-web/node_modules/cache-loader/dist/cjs.js","mtime":1727014166207},{"path":"/home/d/github/box-im/im-web/node_modules/vue-loader/lib/index.js","mtime":1727014163811}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5jaGF0LWJveCB7Cglwb3NpdGlvbjogcmVsYXRpdmU7Cgl3aWR0aDogMTAwJTsKCWJhY2tncm91bmQ6ICNmOGY4Zjg7Cglib3JkZXI6ICNkZGRkZGQgc29saWQgMXB4OwoKCS5lbC1oZWFkZXIgewoJCXBhZGRpbmc6IDNweDsKCQliYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsKCQlsaW5lLWhlaWdodDogNTBweDsKCQlmb250LXNpemU6IDIwcHg7CgkJZm9udC13ZWlnaHQ6IDYwMDsKCQlib3JkZXItYm90dG9tOiAxcHggI2RkZCBzb2xpZDsKCgkJLmJ0bi1zaWRlIHsKCQkJcG9zaXRpb246IGFic29sdXRlOwoJCQlyaWdodDogMjBweDsKCQkJbGluZS1oZWlnaHQ6IDUwcHg7CgkJCWZvbnQtc2l6ZTogMjVweDsKCQkJY3Vyc29yOiBwb2ludGVyOwoJCX0KCX0KCgkuaW0tY2hhdC1tYWluIHsKCQlwYWRkaW5nOiAwOwoJCWJhY2tncm91bmQtY29sb3I6ICNmOGY4Zjg7CgoJCS5pbS1jaGF0LWJveCB7CgkJCT51bCB7CgkJCQlwYWRkaW5nOiAwIDIwcHg7CgoJCQkJbGkgewoJCQkJCWxpc3Qtc3R5bGUtdHlwZTogbm9uZTsKCQkJCX0KCQkJfQoJCX0KCX0KCgkuaW0tY2hhdC1mb290ZXIgewoJCWRpc3BsYXk6IGZsZXg7CgkJZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKCQlwYWRkaW5nOiAwOwoKCQkuY2hhdC10b29sLWJhciB7CgkJCWRpc3BsYXk6IGZsZXg7CgkJCXBvc2l0aW9uOiByZWxhdGl2ZTsKCQkJd2lkdGg6IDEwMCU7CgkJCWhlaWdodDogNDBweDsKCQkJdGV4dC1hbGlnbjogbGVmdDsKCQkJYm94LXNpemluZzogYm9yZGVyLWJveDsKCQkJYm9yZGVyLXRvcDogI2NjYyBzb2xpZCAxcHg7CgkJCXBhZGRpbmc6IDJweDsKCQkJYmFja2dyb3VuZC1jb2xvcjogI2U4ZjJmZjsKCgkJCT5kaXYgewoJCQkJZm9udC1zaXplOiAyMnB4OwoJCQkJY3Vyc29yOiBwb2ludGVyOwoJCQkJY29sb3I6IGJsYWNrOwoJCQkJbGluZS1oZWlnaHQ6IDMwcHg7CgkJCQl3aWR0aDogMzBweDsKCQkJCWhlaWdodDogMzBweDsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJCWJvcmRlci1yYWRpdXM6IDNweDsKCQkJCW1hcmdpbjogM3B4OwoKCQkJCSY6aG92ZXIgewoJCQkJCWNvbG9yOiBibGFjazsKCQkJCX0KCgkJCQkmLmNoYXQtdG9vbC1hY3RpdmUgewoJCQkJCWZvbnQtd2VpZ2h0OiA2MDA7CgkJCQkJY29sb3I6ICMxOTVlZTI7CgkJCQkJYmFja2dyb3VuZC1jb2xvcjogI2RkZDsKCQkJCX0KCQkJfQoKCQkJPmRpdjpob3ZlciB7CgkJCQljb2xvcjogIzk0OTQ5NDsKCQkJfQoJCX0KCgkJLnNlbmQtY29udGVudC1hcmVhIHsKCQkJcG9zaXRpb246IHJlbGF0aXZlOwoJCQlkaXNwbGF5OiBmbGV4OwoJCQlmbGV4LWRpcmVjdGlvbjogY29sdW1uOwoJCQloZWlnaHQ6IDEwMCU7CgkJCWJhY2tncm91bmQtY29sb3I6IHdoaXRlICFpbXBvcnRhbnQ7CgoJCQkuc2VuZC10ZXh0LWFyZWEgewoJCQkJYm94LXNpemluZzogYm9yZGVyLWJveDsKCQkJCXBhZGRpbmc6IDVweDsKCQkJCXdpZHRoOiAxMDAlOwoJCQkJZmxleDogMTsKCQkJCXJlc2l6ZTogbm9uZTsKCQkJCWZvbnQtc2l6ZTogMTZweDsKCQkJCWNvbG9yOiBibGFjazsKCQkJCW91dGxpbmU6IG5vbmU7CgoJCQkJdGV4dC1hbGlnbjogbGVmdDsKCQkJCWxpbmUtaGVpZ2h0OiAzMHB4OwoKCQkJCSY6YmVmb3JlIHsKCQkJCQljb250ZW50OiBhdHRyKHBsYWNlaG9sZGVyKTsKCQkJCQljb2xvcjogZ3JheTsKCQkJCX0KCgkJCQkuYXQgewoJCQkJCWNvbG9yOiBibHVlOwoJCQkJCWZvbnQtd2VpZ2h0OiA2MDA7CgkJCQl9CgoJCQkJLnJlY2VpcHQgewoJCQkJCWNvbG9yOiBkYXJrYmx1ZTsKCQkJCQlmb250LXNpemU6IDE1cHg7CgkJCQkJZm9udC13ZWlnaHQ6IDYwMDsKCQkJCX0KCgkJCQkuZW1vIHsKCQkJCQl3aWR0aDogMzBweDsKCQkJCQloZWlnaHQ6IDMwcHg7CgkJCQkJdmVydGljYWwtYWxpZ246IGJvdHRvbTsKCQkJCX0KCQkJfQoKCQkJLnNlbmQtaW1hZ2UtYXJlYSB7CgkJCQl0ZXh0LWFsaWduOiBsZWZ0OwoJCQkJYm9yZGVyOiAjNTNhMGU3IHNvbGlkIDFweDsKCgkJCQkuc2VuZC1pbWFnZS1ib3ggewoJCQkJCXBvc2l0aW9uOiByZWxhdGl2ZTsKCQkJCQlkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CgoJCQkJCS5zZW5kLWltYWdlIHsKCQkJCQkJbWF4LWhlaWdodDogMTgwcHg7CgkJCQkJCWJvcmRlcjogMXB4IHNvbGlkICNjY2M7CgkJCQkJCWJvcmRlci1yYWRpdXM6IDIlOwoJCQkJCQltYXJnaW46IDJweDsKCQkJCQl9CgoJCQkJCS5zZW5kLWltYWdlLWNsb3NlIHsKCQkJCQkJcG9zaXRpb246IGFic29sdXRlOwoJCQkJCQlwYWRkaW5nOiAzcHg7CgkJCQkJCXJpZ2h0OiA3cHg7CgkJCQkJCXRvcDogN3B4OwoJCQkJCQljb2xvcjogd2hpdGU7CgkJCQkJCWN1cnNvcjogcG9pbnRlcjsKCQkJCQkJZm9udC1zaXplOiAxNXB4OwoJCQkJCQlmb250LXdlaWdodDogNjAwOwoJCQkJCQliYWNrZ3JvdW5kLWNvbG9yOiAjYWFhOwoJCQkJCQlib3JkZXItcmFkaXVzOiA1MCU7CgkJCQkJCWJvcmRlcjogMXB4IHNvbGlkICNjY2M7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkuc2VuZC1idG4tYXJlYSB7CgkJCQlwYWRkaW5nOiAxMHB4OwoJCQkJcG9zaXRpb246IGFic29sdXRlOwoJCQkJYm90dG9tOiAwOwoJCQkJcmlnaHQ6IDA7CgkJCX0KCQl9Cgl9CgoJLmNoYXQtZ3JvdXAtc2lkZS1ib3ggewoJCWJvcmRlcjogI2RkZGRkZCBzb2xpZCAxcHg7CgkJYW5pbWF0aW9uOiBydGwtZHJhd2VyLWluIC4zcyAxbXM7Cgl9Cn0K"},{"version":3,"sources":["ChatBox.vue"],"names":[],"mappings":";AA+0BA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"ChatBox.vue","sourceRoot":"src/components/chat","sourcesContent":["<template>\n\t<div class=\"chat-box\" @click=\"closeRefBox()\" @mousemove=\"readedMessage()\">\n\t\t<el-container>\n\t\t\t<el-header height=\"56px\">\n\t\t\t\t<span>{{ title }}</span>\n\t\t\t\t<span title=\"群聊信息\" v-show=\"this.chat.type == 'GROUP'\" class=\"btn-side el-icon-more\"\n\t\t\t\t\t@click=\"showSide = !showSide\"></span>\n\t\t\t</el-header>\n\t\t\t<el-main style=\"padding: 0;\">\n\t\t\t\t<el-container>\n\t\t\t\t\t<el-container class=\"content-box\">\n\t\t\t\t\t\t<el-main class=\"im-chat-main\" id=\"chatScrollBox\" @scroll=\"onScroll\">\n\t\t\t\t\t\t\t<div class=\"im-chat-box\">\n\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t<li v-for=\"(msgInfo, idx) in chat.messages\" :key=\"idx\">\n\t\t\t\t\t\t\t\t\t\t<chat-message-item v-if=\"idx >= showMinIdx\" @call=\"onCall(msgInfo.type)\"\n\t\t\t\t\t\t\t\t\t\t\t:mine=\"msgInfo.sendId == mine.id\" :headImage=\"headImage(msgInfo)\"\n\t\t\t\t\t\t\t\t\t\t\t:showName=\"showName(msgInfo)\" :msgInfo=\"msgInfo\"\n\t\t\t\t\t\t\t\t\t\t\t:groupMembers=\"groupMembers\" @delete=\"deleteMessage\"\n\t\t\t\t\t\t\t\t\t\t\t@recall=\"recallMessage\">\n\t\t\t\t\t\t\t\t\t\t</chat-message-item>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</el-main>\n\t\t\t\t\t\t<el-footer height=\"240px\" class=\"im-chat-footer\">\n\t\t\t\t\t\t\t<div class=\"chat-tool-bar\">\n\t\t\t\t\t\t\t\t<div title=\"表情\" class=\"icon iconfont icon-emoji\" ref=\"emotion\"\n\t\t\t\t\t\t\t\t\t@click.stop=\"showEmotionBox()\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div title=\"发送图片\">\n\t\t\t\t\t\t\t\t\t<file-upload :action=\"'/image/upload'\" :maxSize=\"5 * 1024 * 1024\"\n\t\t\t\t\t\t\t\t\t\t:fileTypes=\"['image/jpeg', 'image/png', 'image/jpg', 'image/webp', 'image/gif']\"\n\t\t\t\t\t\t\t\t\t\t@before=\"onImageBefore\" @success=\"onImageSuccess\" @fail=\"onImageFail\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"el-icon-picture-outline\"></i>\n\t\t\t\t\t\t\t\t\t</file-upload>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div title=\"发送文件\">\n\t\t\t\t\t\t\t\t\t<file-upload ref=\"fileUpload\" :action=\"'/file/upload'\" :maxSize=\"10 * 1024 * 1024\"\n\t\t\t\t\t\t\t\t\t\t@before=\"onFileBefore\" @success=\"onFileSuccess\" @fail=\"onFileFail\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"el-icon-wallet\"></i>\n\t\t\t\t\t\t\t\t\t</file-upload>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div title=\"回执消息\" v-show=\"chat.type == 'GROUP'\" class=\"icon iconfont icon-receipt\"\n\t\t\t\t\t\t\t\t\t:class=\"isReceipt ? 'chat-tool-active' : ''\" @click=\"onSwitchReceipt\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div title=\"发送语音\" class=\"el-icon-microphone\" @click=\"showRecordBox()\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div title=\"语音通话\" v-show=\"chat.type == 'PRIVATE'\" class=\"el-icon-phone-outline\"\n\t\t\t\t\t\t\t\t\t@click=\"showPrivateVideo('voice')\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div title=\"语音通话\" v-show=\"chat.type == 'GROUP'\" class=\"el-icon-phone-outline\"\n\t\t\t\t\t\t\t\t\t@click=\"onGroupVideo()\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div title=\"视频通话\" v-show=\"chat.type == 'PRIVATE'\" class=\"el-icon-video-camera\"\n\t\t\t\t\t\t\t\t\t@click=\"showPrivateVideo('video')\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div title=\"聊天记录\" class=\"el-icon-chat-dot-round\" @click=\"showHistoryBox()\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"send-content-area\">\n\t\t\t\t\t\t\t\t<ChatInput :ownerId=\"group.ownerId\" ref=\"chatInputEditor\" :group-members=\"groupMembers\"\n\t\t\t\t\t\t\t\t\t@submit=\"sendMessage\" />\n\t\t\t\t\t\t\t\t<div class=\"send-btn-area\">\n\t\t\t\t\t\t\t\t\t<el-button type=\"primary\" size=\"small\" @click=\"notifySend()\">发送</el-button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</el-footer>\n\t\t\t\t\t</el-container>\n\t\t\t\t\t<el-aside class=\"chat-group-side-box\" width=\"300px\" v-if=\"showSide\">\n\t\t\t\t\t\t<chat-group-side :group=\"group\" :groupMembers=\"groupMembers\" @reload=\"loadGroup(group.id)\">\n\t\t\t\t\t\t</chat-group-side>\n\t\t\t\t\t</el-aside>\n\t\t\t\t</el-container>\n\t\t\t</el-main>\n\t\t\t<emotion ref=\"emoBox\" @emotion=\"onEmotion\"></Emotion>\n\t\t\t<chat-record :visible=\"showRecord\" @close=\"closeRecordBox\" @send=\"onSendRecord\"></chat-record>\n\t\t\t<group-member-selector ref=\"rtcSel\" :groupId=\"group.id\" @complete=\"onInviteOk\"></group-member-selector>\n\t\t\t<rtc-group-join ref=\"rtcJoin\" :groupId=\"group.id\"></rtc-group-join>\n\t\t\t<chat-history :visible=\"showHistory\" :chat=\"chat\" :friend=\"friend\" :group=\"group\"\n\t\t\t\t:groupMembers=\"groupMembers\" @close=\"closeHistoryBox\"></chat-history>\n\t\t</el-container>\n\t</div>\n</template>\n\n<script>\n\timport ChatGroupSide from \"./ChatGroupSide.vue\";\n\timport ChatMessageItem from \"./ChatMessageItem.vue\";\n\timport FileUpload from \"../common/FileUpload.vue\";\n\timport Emotion from \"../common/Emotion.vue\";\n\timport ChatRecord from \"./ChatRecord.vue\";\n\timport ChatHistory from \"./ChatHistory.vue\";\n\timport ChatAtBox from \"./ChatAtBox.vue\"\n\timport GroupMemberSelector from \"../group/GroupMemberSelector.vue\"\n\timport RtcGroupJoin from \"../rtc/RtcGroupJoin.vue\"\n\timport ChatInput from \"./ChatInput\";\n\n\n\texport default {\n\t\tname: \"chatPrivate\",\n\t\tcomponents: {\n\t\t\tChatInput,\n\t\t\tChatMessageItem,\n\t\t\tFileUpload,\n\t\t\tChatGroupSide,\n\t\t\tEmotion,\n\t\t\tChatRecord,\n\t\t\tChatHistory,\n\t\t\tChatAtBox,\n\t\t\tGroupMemberSelector,\n\t\t\tRtcGroupJoin\n\t\t},\n\t\tprops: {\n\t\t\tchat: {\n\t\t\t\ttype: Object\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tfriend: {},\n\t\t\t\tgroup: {},\n\t\t\t\tgroupMembers: [],\n\t\t\t\tsendImageUrl: \"\",\n\t\t\t\tsendImageFile: \"\",\n\t\t\t\tplaceholder: \"\",\n\t\t\t\tisReceipt: true,\n\t\t\t\tshowRecord: false, // 是否显示语音录制弹窗\n\t\t\t\tshowSide: false, // 是否显示群聊信息栏\n\t\t\t\tshowHistory: false, // 是否显示历史聊天记录\n\t\t\t\tlockMessage: false, // 是否锁定发送，\n\t\t\t\tshowMinIdx: 0, // 下标低于showMinIdx的消息不显示，否则页面会很卡置\n\t\t\t\treqQueue: [],\n\t\t\t\tisSending : false\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tmoveChatToTop() {\n\t\t\t\tlet chatIdx = this.$store.getters.findChatIdx(this.chat);\n\t\t\t\tthis.$store.commit(\"moveTop\", chatIdx);\n\t\t\t},\n\t\t\tcloseRefBox() {\n\t\t\t\tthis.$refs.emoBox.close();\n\t\t\t\t// this.$refs.atBox.close();\n\t\t\t},\n\t\t\tonCall(type) {\n\t\t\t\tif (type == this.$enums.MESSAGE_TYPE.ACT_RT_VOICE) {\n\t\t\t\t\tthis.showPrivateVideo('voice');\n\t\t\t\t} else if (type == this.$enums.MESSAGE_TYPE.ACT_RT_VIDEO) {\n\t\t\t\t\tthis.showPrivateVideo('video');\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSwitchReceipt() {\n\t\t\t\tthis.isReceipt = !this.isReceipt;\n\t\t\t\tthis.refreshPlaceHolder();\n\t\t\t},\n\t\t\tonImageSuccess(data, file) {\n\t\t\t\tlet msgInfo = JSON.parse(JSON.stringify(file.msgInfo));\n\t\t\t\tmsgInfo.content = JSON.stringify(data);\n\t\t\t\tmsgInfo.receipt = this.isReceipt;\n\t\t\t\tthis.sendMessageRequest(msgInfo).then((m) => {\n\t\t\t\t\tmsgInfo.loadStatus = 'ok';\n\t\t\t\t\tmsgInfo.id = m.id;\n\t\t\t\t\tthis.isReceipt = false;\n\t\t\t\t\tthis.$store.commit(\"insertMessage\", msgInfo);\n\t\t\t\t})\n\t\t\t},\n\t\t\tonImageFail(e, file) {\n\t\t\t\tlet msgInfo = JSON.parse(JSON.stringify(file.msgInfo));\n\t\t\t\tmsgInfo.loadStatus = 'fail';\n\t\t\t\tthis.$store.commit(\"insertMessage\", msgInfo);\n\t\t\t},\n\t\t\tonImageBefore(file) {\n\t\t\t\tlet url = URL.createObjectURL(file);\n\t\t\t\tlet data = {\n\t\t\t\t\toriginUrl: url,\n\t\t\t\t\tthumbUrl: url\n\t\t\t\t}\n\t\t\t\tlet msgInfo = {\n\t\t\t\t\tid: 0,\n\t\t\t\t\ttmpId: this.generateId(),\n\t\t\t\t\tfileId: file.uid,\n\t\t\t\t\tsendId: this.mine.id,\n\t\t\t\t\tcontent: JSON.stringify(data),\n\t\t\t\t\tsendTime: new Date().getTime(),\n\t\t\t\t\tselfSend: true,\n\t\t\t\t\ttype: 1,\n\t\t\t\t\treadedCount: 0,\n\t\t\t\t\tloadStatus: \"loading\",\n\t\t\t\t\tstatus: this.$enums.MESSAGE_STATUS.UNSEND\n\t\t\t\t}\n\t\t\t\t// 填充对方id\n\t\t\t\tthis.fillTargetId(msgInfo, this.chat.targetId);\n\t\t\t\t// 插入消息\n\t\t\t\tthis.$store.commit(\"insertMessage\", msgInfo);\n\t\t\t\t// 会话置顶\n\t\t\t\tthis.moveChatToTop();\n\t\t\t\t// 滚动到底部\n\t\t\t\tthis.scrollToBottom();\n\t\t\t\t// 借助file对象保存\n\t\t\t\tfile.msgInfo = msgInfo;\n\t\t\t},\n\t\t\tonFileSuccess(url, file) {\n\t\t\t\tlet data = {\n\t\t\t\t\tname: file.name,\n\t\t\t\t\tsize: file.size,\n\t\t\t\t\turl: url\n\t\t\t\t}\n\t\t\t\tlet msgInfo = JSON.parse(JSON.stringify(file.msgInfo));\n\t\t\t\tmsgInfo.content = JSON.stringify(data);\n\t\t\t\tmsgInfo.receipt = this.isReceipt\n\t\t\t\tthis.sendMessageRequest(msgInfo).then((m) => {\n\t\t\t\t\tmsgInfo.loadStatus = 'ok';\n\t\t\t\t\tmsgInfo.id = m.id;\n\t\t\t\t\tthis.isReceipt = false;\n\t\t\t\t\tthis.refreshPlaceHolder();\n\t\t\t\t\tthis.$store.commit(\"insertMessage\", msgInfo);\n\t\t\t\t})\n\t\t\t},\n\t\t\tonFileFail(e, file) {\n\t\t\t\tlet msgInfo = JSON.parse(JSON.stringify(file.msgInfo));\n\t\t\t\tmsgInfo.loadStatus = 'fail';\n\t\t\t\tthis.$store.commit(\"insertMessage\", msgInfo);\n\t\t\t},\n\t\t\tonFileBefore(file) {\n\t\t\t\tlet url = URL.createObjectURL(file);\n\t\t\t\tlet data = {\n\t\t\t\t\tname: file.name,\n\t\t\t\t\tsize: file.size,\n\t\t\t\t\turl: url\n\t\t\t\t}\n\t\t\t\tlet msgInfo = {\n\t\t\t\t\tid: 0,\n\t\t\t\t\ttmpId: this.generateId(),\n\t\t\t\t\tsendId: this.mine.id,\n\t\t\t\t\tcontent: JSON.stringify(data),\n\t\t\t\t\tsendTime: new Date().getTime(),\n\t\t\t\t\tselfSend: true,\n\t\t\t\t\ttype: 2,\n\t\t\t\t\tloadStatus: \"loading\",\n\t\t\t\t\treadedCount: 0,\n\t\t\t\t\tstatus: this.$enums.MESSAGE_STATUS.UNSEND\n\t\t\t\t}\n\t\t\t\t// 填充对方id\n\t\t\t\tthis.fillTargetId(msgInfo, this.chat.targetId);\n\t\t\t\t// 插入消息\n\t\t\t\tthis.$store.commit(\"insertMessage\", msgInfo);\n\t\t\t\t// 会话置顶\n\t\t\t\tthis.moveChatToTop();\n\t\t\t\t// 滚动到底部\n\t\t\t\tthis.scrollToBottom();\n\t\t\t\t// 借助file对象透传\n\t\t\t\tfile.msgInfo = msgInfo;\n\t\t\t},\n\t\t\tonCloseSide() {\n\t\t\t\tthis.showSide = false;\n\t\t\t},\n\t\t\tonScrollToTop() {\n\t\t\t\t// 多展示10条信息\n\t\t\t\tthis.showMinIdx = this.showMinIdx > 10 ? this.showMinIdx - 10 : 0;\n\t\t\t},\n\t\t\tonScroll(e) {\n\t\t\t\tlet scrollElement = e.target\n\t\t\t\tlet scrollTop = scrollElement.scrollTop\n\t\t\t\tif (scrollTop < 30) { // 在顶部,不滚动的情况\n\t\t\t\t\t// 多展示20条信息\n\t\t\t\t\tthis.showMinIdx = this.showMinIdx > 20 ? this.showMinIdx - 20 : 0;\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowEmotionBox() {\n\t\t\t\tlet width = this.$refs.emotion.offsetWidth;\n\t\t\t\tlet left = this.$elm.fixLeft(this.$refs.emotion);\n\t\t\t\tlet top = this.$elm.fixTop(this.$refs.emotion);\n\t\t\t\tthis.$refs.emoBox.open({\n\t\t\t\t\tx: left + width / 2,\n\t\t\t\t\ty: top\n\t\t\t\t})\n\t\t\t},\n\t\t\tonEmotion(emoText) {\n\t\t\t\tthis.$refs.chatInputEditor.insertEmoji(emoText);\n\t\t\t},\n\t\t\tshowRecordBox() {\n\t\t\t\tthis.showRecord = true;\n\t\t\t},\n\t\t\tcloseRecordBox() {\n\t\t\t\tthis.showRecord = false;\n\t\t\t},\n\t\t\tshowPrivateVideo(mode) {\n\t\t\t\tlet rtcInfo = {\n\t\t\t\t\tmode: mode,\n\t\t\t\t\tisHost: true,\n\t\t\t\t\tfriend: this.friend,\n\t\t\t\t}\n\t\t\t\t// 通过home.vue打开单人视频窗口\n\t\t\t\tthis.$eventBus.$emit(\"openPrivateVideo\", rtcInfo);\n\t\t\t},\n\t\t\tonGroupVideo() {\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: \"/webrtc/group/info?groupId=\" + this.group.id,\n\t\t\t\t\tmethod: 'GET'\n\t\t\t\t}).then((rtcInfo) => {\n\t\t\t\t\tif (rtcInfo.isChating) {\n\t\t\t\t\t\t// 已在通话中，可以直接加入通话\n\t\t\t\t\t\tthis.$refs.rtcJoin.open(rtcInfo);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 邀请成员发起通话\n\t\t\t\t\t\tlet ids = [this.mine.id];\n\t\t\t\t\t\tlet maxChannel = this.$store.state.configStore.webrtc.maxChannel;\n\t\t\t\t\t\tthis.$refs.rtcSel.open(maxChannel, ids, ids);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t},\n\t\t\tonInviteOk(members) {\n\t\t\t\tif (members.length < 2) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet userInfos = [];\n\t\t\t\tmembers.forEach(m => {\n\t\t\t\t\tuserInfos.push({\n\t\t\t\t\t\tid: m.userId,\n\t\t\t\t\t\tnickName: m.showNickName,\n\t\t\t\t\t\theadImage: m.headImage,\n\t\t\t\t\t\tisCamera: false,\n\t\t\t\t\t\tisMicroPhone: true\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\tlet rtcInfo = {\n\t\t\t\t\tisHost: true,\n\t\t\t\t\tgroupId: this.group.id,\n\t\t\t\t\tinviterId: this.mine.id,\n\t\t\t\t\tuserInfos: userInfos\n\t\t\t\t}\n\t\t\t\t// 通过home.vue打开多人视频窗口\n\t\t\t\tthis.$eventBus.$emit(\"openGroupVideo\", rtcInfo);\n\t\t\t},\n\t\t\tshowHistoryBox() {\n\t\t\t\tthis.showHistory = true;\n\t\t\t},\n\t\t\tcloseHistoryBox() {\n\t\t\t\tthis.showHistory = false;\n\t\t\t},\n\t\t\tonSendRecord(data) {\n\t\t\t\tlet msgInfo = {\n\t\t\t\t\tcontent: JSON.stringify(data),\n\t\t\t\t\ttype: 3,\n\t\t\t\t\treceipt: this.isReceipt\n\t\t\t\t}\n\t\t\t\t// 填充对方id\n\t\t\t\tthis.fillTargetId(msgInfo, this.chat.targetId);\n\t\t\t\tthis.sendMessageRequest(msgInfo).then((m) => {\n\t\t\t\t\tm.selfSend = true;\n\t\t\t\t\tthis.$store.commit(\"insertMessage\", m);\n\t\t\t\t\t// 会话置顶\n\t\t\t\t\tthis.moveChatToTop();\n\t\t\t\t\t// 保持输入框焦点\n\t\t\t\t\tthis.$refs.chatInputEditor.focus();\n\t\t\t\t\t// 滚动到底部\n\t\t\t\t\tthis.scrollToBottom();\n\t\t\t\t\t// 关闭录音窗口\n\t\t\t\t\tthis.showRecord = false;\n\t\t\t\t\tthis.isReceipt = false;\n\t\t\t\t\tthis.refreshPlaceHolder();\n\t\t\t\t})\n\t\t\t},\n\t\t\tfillTargetId(msgInfo, targetId) {\n\t\t\t\tif (this.chat.type == \"GROUP\") {\n\t\t\t\t\tmsgInfo.groupId = targetId;\n\t\t\t\t} else {\n\t\t\t\t\tmsgInfo.recvId = targetId;\n\t\t\t\t}\n\t\t\t},\n\t\t\tnotifySend() {\n\t\t\t\tthis.$refs.chatInputEditor.submit();\n\t\t\t},\n\t\t\tasync sendMessage(fullList) {\n\t\t\t\tthis.resetEditor();\n\t\t\t\tthis.readedMessage();\n\t\t\t\tlet sendText = this.isReceipt ? \"【回执消息】\" : \"\";\n\t\t\t\tlet promiseList = [];\n\t\t\t\tfor (let i = 0; i < fullList.length; i++) {\n\t\t\t\t\tlet msg = fullList[i];\n\t\t\t\t\tswitch (msg.type) {\n\t\t\t\t\t\tcase \"text\":\n\t\t\t\t\t\t\tawait this.sendTextMessage(sendText + msg.content,msg.atUserIds);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"image\":\n\t\t\t\t\t\t\tawait this.sendImageMessage(msg.content.file);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"file\":\n\t\t\t\t\t\t\tawait this.sendFileMessage(msg.content.file);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t}\n\t\t\t},\n\t\t\tsendImageMessage(file) {\n\t\t\t\treturn new Promise((resolve,reject)=>{\n\t\t\t\t\tthis.onImageBefore(file);\n\t\t\t\t\tlet formData = new FormData()\n\t\t\t\t\tformData.append('file', file)\n\t\t\t\t\tthis.$http.post(\"/image/upload\", formData, {\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Content-Type': 'multipart/form-data'\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then((data) => {\n\t\t\t\t\t\tthis.onImageSuccess(data, file);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}).catch((res) => {\n\t\t\t\t\t\tthis.onImageFail(res, file);\n\t\t\t\t\t\treject();\n\t\t\t\t\t})\n\t\t\t\t\tthis.$nextTick(() => this.$refs.chatInputEditor.focus());\n\t\t\t\t\tthis.scrollToBottom();\n\t\t\t\t\t});\n\t\t\t},\n\t\t\t sendTextMessage(sendText,atUserIds) {\n\t\t\t\treturn new Promise((resolve,reject)=>{\n\t\t\t\t\tif (!sendText.trim()) {\n\t\t\t\t\t\treject();\n\t\t\t\t\t}\n\t\t\t\t\tlet msgInfo = {\n\t\t\t\t\t\tcontent: sendText,\n\t\t\t\t\t\ttype: 0\n\t\t\t\t\t}\n\t\t\t\t\t// 填充对方id\n\t\t\t\t\tthis.fillTargetId(msgInfo, this.chat.targetId);\n\t\t\t\t\t// 被@人员列表\n\t\t\t\t\tif (this.chat.type == \"GROUP\") {\n\t\t\t\t\t\tmsgInfo.atUserIds = atUserIds;\n\t\t\t\t\t\tmsgInfo.receipt = this.isReceipt;\n\t\t\t\t\t}\n\t\t\t\t\tthis.lockMessage = true;\n\t\t\t\t\tthis.sendMessageRequest(msgInfo).then((m) => {\n\t\t\t\t\t\tm.selfSend = true;\n\t\t\t\t\t\tthis.$store.commit(\"insertMessage\", m);\n\t\t\t\t\t\t// 会话置顶\n\t\t\t\t\t\tthis.moveChatToTop();\n\t\t\t\t\t}).finally(() => {\n\t\t\t\t\t\t// 解除锁定\n\t\t\t\t\t\tthis.scrollToBottom();\n\t\t\t\t\t\tthis.isReceipt = false;\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tsendFileMessage(file) {\n\t\t\t\treturn new Promise((resolve,reject)=>{\n\t\t\t\t\tlet check = this.$refs.fileUpload.beforeUpload(file);\n\t\t\t\t\tif (check) {\n\t\t\t\t\t\tthis.$refs.fileUpload.onFileUpload({ file });\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tdeleteMessage(msgInfo) {\n\t\t\t\tthis.$confirm('确认删除消息?', '删除消息', {\n\t\t\t\t\tconfirmButtonText: '确定',\n\t\t\t\t\tcancelButtonText: '取消',\n\t\t\t\t\ttype: 'warning'\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.$store.commit(\"deleteMessage\", msgInfo);\n\t\t\t\t});\n\t\t\t},\n\t\t\trecallMessage(msgInfo) {\n\t\t\t\tthis.$confirm('确认撤回消息?', '撤回消息', {\n\t\t\t\t\tconfirmButtonText: '确定',\n\t\t\t\t\tcancelButtonText: '取消',\n\t\t\t\t\ttype: 'warning'\n\t\t\t\t}).then(() => {\n\t\t\t\t\tlet url = `/message/${this.chat.type.toLowerCase()}/recall/${msgInfo.id}`\n\t\t\t\t\tthis.$http({\n\t\t\t\t\t\turl: url,\n\t\t\t\t\t\tmethod: 'delete'\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tthis.$message.success(\"消息已撤回\");\n\t\t\t\t\t\tmsgInfo = JSON.parse(JSON.stringify(msgInfo));\n\t\t\t\t\t\tmsgInfo.type = 10;\n\t\t\t\t\t\tmsgInfo.content = '你撤回了一条消息';\n\t\t\t\t\t\tmsgInfo.status = this.$enums.MESSAGE_STATUS.RECALL;\n\t\t\t\t\t\tthis.$store.commit(\"insertMessage\", msgInfo);\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t},\n\t\t\treadedMessage() {\n\t\t\t\tif (this.chat.unreadCount == 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.$store.commit(\"resetUnreadCount\", this.chat)\n\t\t\t\tif (this.chat.type == \"GROUP\") {\n\t\t\t\t\tvar url = `/message/group/readed?groupId=${this.chat.targetId}`\n\t\t\t\t} else {\n\t\t\t\t\turl = `/message/private/readed?friendId=${this.chat.targetId}`\n\t\t\t\t}\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: url,\n\t\t\t\t\tmethod: 'put'\n\t\t\t\t}).then(() => {})\n\t\t\t},\n\t\t\tloadReaded(fId) {\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: `/message/private/maxReadedId?friendId=${fId}`,\n\t\t\t\t\tmethod: 'get'\n\t\t\t\t}).then((id) => {\n\t\t\t\t\tthis.$store.commit(\"readedMessage\", {\n\t\t\t\t\t\tfriendId: fId,\n\t\t\t\t\t\tmaxId: id\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tloadGroup(groupId) {\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: `/group/find/${groupId}`,\n\t\t\t\t\tmethod: 'get'\n\t\t\t\t}).then((group) => {\n\t\t\t\t\tthis.group = group;\n\t\t\t\t\tthis.$store.commit(\"updateChatFromGroup\", group);\n\t\t\t\t\tthis.$store.commit(\"updateGroup\", group);\n\t\t\t\t});\n\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: `/group/members/${groupId}`,\n\t\t\t\t\tmethod: 'get'\n\t\t\t\t}).then((groupMembers) => {\n\t\t\t\t\tthis.groupMembers = groupMembers;\n\t\t\t\t});\n\t\t\t},\n\t\t\tloadFriend(friendId) {\n\t\t\t\t// 获取对方最新信息\n\t\t\t\tthis.$http({\n\t\t\t\t\turl: `/user/find/${friendId}`,\n\t\t\t\t\tmethod: 'get'\n\t\t\t\t}).then((friend) => {\n\t\t\t\t\tthis.friend = friend;\n\t\t\t\t\tthis.$store.commit(\"updateChatFromFriend\", friend);\n\t\t\t\t\tthis.$store.commit(\"updateFriend\", friend);\n\t\t\t\t})\n\t\t\t},\n\t\t\tshowName(msgInfo) {\n\t\t\t\tif (this.chat.type == 'GROUP') {\n\t\t\t\t\tlet member = this.groupMembers.find((m) => m.userId == msgInfo.sendId);\n\t\t\t\t\treturn member ? member.showNickName : \"\";\n\t\t\t\t} else {\n\t\t\t\t\treturn msgInfo.sendId == this.mine.id ? this.mine.nickName : this.chat.showName\n\t\t\t\t}\n\n\t\t\t},\n\t\t\theadImage(msgInfo) {\n\t\t\t\tif (this.chat.type == 'GROUP') {\n\t\t\t\t\tlet member = this.groupMembers.find((m) => m.userId == msgInfo.sendId);\n\t\t\t\t\treturn member ? member.headImage : \"\";\n\t\t\t\t} else {\n\t\t\t\t\treturn msgInfo.sendId == this.mine.id ? this.mine.headImageThumb : this.chat.headImage\n\t\t\t\t}\n\t\t\t},\n\t\t\tresetEditor() {\n\t\t\t\t\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.$refs.chatInputEditor.clear();\n\t\t\t\t\tthis.$refs.chatInputEditor.focus();\n\t\t\t\t});\n\t\t\t},\n\t\t\tscrollToBottom() {\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tlet div = document.getElementById(\"chatScrollBox\");\n\t\t\t\t\tdiv.scrollTop = div.scrollHeight;\n\t\t\t\t});\n\t\t\t},\n\t\t\trefreshPlaceHolder() {\n\t\t\t\tif (this.isReceipt) {\n\t\t\t\t\tthis.placeholder = \"【回执消息】\"\n\t\t\t\t} else if (this.$refs.editBox && this.$refs.editBox.innerHTML) {\n\t\t\t\t\tthis.placeholder = \"\"\n\t\t\t\t} else {\n\t\t\t\t\tthis.placeholder = \"聊点什么吧~\";\n\t\t\t\t}\n\t\t\t},\n\t\t\tsendMessageRequest(msgInfo){\n\t\t\t\treturn  new Promise((resolve,reject)=>{\n\t\t\t\t\t// 请求入队列，防止请求\"后发先至\"，导致消息错序\n\t\t\t\t\tthis.reqQueue.push({msgInfo,resolve,reject});\n\t\t\t\t\tthis.processReqQueue();\n\t\t\t\t})\n\t\t\t},\n\t\t\tprocessReqQueue(){\n\t\t\t\tif (this.reqQueue.length && !this.isSending) {\n\t\t\t\t\tthis.isSending = true;\n\t\t\t\t\tconst reqData = this.reqQueue.shift();\n\t\t\t\t\tthis.$http({\n\t\t\t\t\t\turl: this.messageAction,\n\t\t\t\t\t\tmethod: 'post',\n\t\t\t\t\t\tdata: reqData.msgInfo\n\t\t\t\t\t}).then((res)=>{\n\t\t\t\t\t\treqData.resolve(res)\n\t\t\t\t\t}).catch((e)=>{\n\t\t\t\t\t\treqData.reject(e)\n\t\t\t\t\t}).finally(()=>{\n\t\t\t\t\t\tthis.isSending = false;\n\t\t\t\t\t\t// 发送下一条请求\n\t\t\t\t\t\tthis.processReqQueue();\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\t\t\tgenerateId() {\n\t\t\t\t// 生成临时id\n\t\t\t\treturn String(new Date().getTime()) + String(Math.floor(Math.random() * 1000));\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\tmine() {\n\t\t\t\treturn this.$store.state.userStore.userInfo;\n\t\t\t},\n\t\t\ttitle() {\n\t\t\t\tlet title = this.chat.showName;\n\t\t\t\tif (this.chat.type == \"GROUP\") {\n\t\t\t\t\tlet size = this.groupMembers.filter(m => !m.quit).length;\n\t\t\t\t\ttitle += `(${size})`;\n\t\t\t\t}\n\t\t\t\treturn title;\n\t\t\t},\n\t\t\tmessageAction() {\n\t\t\t\treturn `/message/${this.chat.type.toLowerCase()}/send`;\n\t\t\t},\n\t\t\tunreadCount() {\n\t\t\t\treturn this.chat.unreadCount;\n\t\t\t},\n\t\t\tmessageSize() {\n\t\t\t\tif (!this.chat || !this.chat.messages) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\treturn this.chat.messages.length;\n\t\t\t}\n\t\t},\n\t\twatch: {\n\t\t\tchat: {\n\t\t\t\thandler(newChat, oldChat) {\n\t\t\t\t\tif (newChat.targetId > 0 && (!oldChat || newChat.type != oldChat.type ||\n\t\t\t\t\t\t\tnewChat.targetId != oldChat.targetId)) {\n\t\t\t\t\t\tif (this.chat.type == \"GROUP\") {\n\t\t\t\t\t\t\tthis.loadGroup(this.chat.targetId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.loadFriend(this.chat.targetId);\n\t\t\t\t\t\t\t// 加载已读状态\n\t\t\t\t\t\t\tthis.loadReaded(this.chat.targetId)\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 滚到底部\n\t\t\t\t\t\tthis.scrollToBottom();\n\t\t\t\t\t\tthis.showSide = false;\n\t\t\t\t\t\t// 消息已读\n\t\t\t\t\t\tthis.readedMessage()\n\t\t\t\t\t\t// 初始状态只显示30条消息\n\t\t\t\t\t\tlet size = this.chat.messages.length;\n\t\t\t\t\t\tthis.showMinIdx = size > 30 ? size - 30 : 0;\n\t\t\t\t\t\t// 重置输入框\n\t\t\t\t\t\tthis.resetEditor();\n\t\t\t\t\t\t// 复位回执消息\n\t\t\t\t\t\tthis.isReceipt = false;\n\t\t\t\t\t\t// 更新placeholder\n\t\t\t\t\t\tthis.refreshPlaceHolder();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\timmediate: true\n\t\t\t},\n\t\t\tmessageSize: {\n\t\t\t\thandler(newSize, oldSize) {\n\t\t\t\t\tif (newSize > oldSize) {\n\t\t\t\t\t\t// 拉至底部\n\t\t\t\t\t\tthis.scrollToBottom();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tmounted() {\n\t\t\tlet div = document.getElementById(\"chatScrollBox\");\n\t\t\tdiv.addEventListener('scroll', this.onScroll)\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\t.chat-box {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t\tbackground: #f8f8f8;\n\t\tborder: #dddddd solid 1px;\n\n\t\t.el-header {\n\t\t\tpadding: 3px;\n\t\t\tbackground-color: white;\n\t\t\tline-height: 50px;\n\t\t\tfont-size: 20px;\n\t\t\tfont-weight: 600;\n\t\t\tborder-bottom: 1px #ddd solid;\n\n\t\t\t.btn-side {\n\t\t\t\tposition: absolute;\n\t\t\t\tright: 20px;\n\t\t\t\tline-height: 50px;\n\t\t\t\tfont-size: 25px;\n\t\t\t\tcursor: pointer;\n\t\t\t}\n\t\t}\n\n\t\t.im-chat-main {\n\t\t\tpadding: 0;\n\t\t\tbackground-color: #f8f8f8;\n\n\t\t\t.im-chat-box {\n\t\t\t\t>ul {\n\t\t\t\t\tpadding: 0 20px;\n\n\t\t\t\t\tli {\n\t\t\t\t\t\tlist-style-type: none;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.im-chat-footer {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tpadding: 0;\n\n\t\t\t.chat-tool-bar {\n\t\t\t\tdisplay: flex;\n\t\t\t\tposition: relative;\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 40px;\n\t\t\t\ttext-align: left;\n\t\t\t\tbox-sizing: border-box;\n\t\t\t\tborder-top: #ccc solid 1px;\n\t\t\t\tpadding: 2px;\n\t\t\t\tbackground-color: #e8f2ff;\n\n\t\t\t\t>div {\n\t\t\t\t\tfont-size: 22px;\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t\tcolor: black;\n\t\t\t\t\tline-height: 30px;\n\t\t\t\t\twidth: 30px;\n\t\t\t\t\theight: 30px;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tborder-radius: 3px;\n\t\t\t\t\tmargin: 3px;\n\n\t\t\t\t\t&:hover {\n\t\t\t\t\t\tcolor: black;\n\t\t\t\t\t}\n\n\t\t\t\t\t&.chat-tool-active {\n\t\t\t\t\t\tfont-weight: 600;\n\t\t\t\t\t\tcolor: #195ee2;\n\t\t\t\t\t\tbackground-color: #ddd;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t>div:hover {\n\t\t\t\t\tcolor: #949494;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.send-content-area {\n\t\t\t\tposition: relative;\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\theight: 100%;\n\t\t\t\tbackground-color: white !important;\n\n\t\t\t\t.send-text-area {\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t\tpadding: 5px;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tflex: 1;\n\t\t\t\t\tresize: none;\n\t\t\t\t\tfont-size: 16px;\n\t\t\t\t\tcolor: black;\n\t\t\t\t\toutline: none;\n\n\t\t\t\t\ttext-align: left;\n\t\t\t\t\tline-height: 30px;\n\n\t\t\t\t\t&:before {\n\t\t\t\t\t\tcontent: attr(placeholder);\n\t\t\t\t\t\tcolor: gray;\n\t\t\t\t\t}\n\n\t\t\t\t\t.at {\n\t\t\t\t\t\tcolor: blue;\n\t\t\t\t\t\tfont-weight: 600;\n\t\t\t\t\t}\n\n\t\t\t\t\t.receipt {\n\t\t\t\t\t\tcolor: darkblue;\n\t\t\t\t\t\tfont-size: 15px;\n\t\t\t\t\t\tfont-weight: 600;\n\t\t\t\t\t}\n\n\t\t\t\t\t.emo {\n\t\t\t\t\t\twidth: 30px;\n\t\t\t\t\t\theight: 30px;\n\t\t\t\t\t\tvertical-align: bottom;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.send-image-area {\n\t\t\t\t\ttext-align: left;\n\t\t\t\t\tborder: #53a0e7 solid 1px;\n\n\t\t\t\t\t.send-image-box {\n\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\tdisplay: inline-block;\n\n\t\t\t\t\t\t.send-image {\n\t\t\t\t\t\t\tmax-height: 180px;\n\t\t\t\t\t\t\tborder: 1px solid #ccc;\n\t\t\t\t\t\t\tborder-radius: 2%;\n\t\t\t\t\t\t\tmargin: 2px;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t.send-image-close {\n\t\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\t\tpadding: 3px;\n\t\t\t\t\t\t\tright: 7px;\n\t\t\t\t\t\t\ttop: 7px;\n\t\t\t\t\t\t\tcolor: white;\n\t\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t\t\tfont-size: 15px;\n\t\t\t\t\t\t\tfont-weight: 600;\n\t\t\t\t\t\t\tbackground-color: #aaa;\n\t\t\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\t\t\tborder: 1px solid #ccc;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.send-btn-area {\n\t\t\t\t\tpadding: 10px;\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\tbottom: 0;\n\t\t\t\t\tright: 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.chat-group-side-box {\n\t\t\tborder: #dddddd solid 1px;\n\t\t\tanimation: rtl-drawer-in .3s 1ms;\n\t\t}\n\t}\n</style>"]}]}